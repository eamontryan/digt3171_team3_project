<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <title>Security Posture Dashboard</title>

  <!-- Fonts and icons -->
  <link href="https://fonts.googleapis.com/css?family=Poppins:200,300,400,600,700,800" rel="stylesheet" />
  <link href="https://use.fontawesome.com/releases/v5.0.6/css/all.css" rel="stylesheet">

  <!-- CSS -->
  <link href="styles.css?v=2" rel="stylesheet" />
</head>

<body class="">
  <div class="wrapper">

    <!-- SIDEBAR -->
    <div class="sidebar" data-color="orange">
      <div class="sidebar-wrapper">

        <div class="logo">
          <a href="javascript:void(0)" class="simple-text logo-mini">DT</a>
          <a href="javascript:void(0)" class="simple-text logo-normal">Security Posture</a>
        </div>

        <ul class="nav">
          <li class="active">
            <a href="#overview">
              <p>Dashboard</p>
            </a>
          </li>
          <li>
            <a href="#pie-charts">
              <p>Breakdowns</p>
            </a>
          </li>
          <li>
            <a href="#tables">
              <p>Details</p>
            </a>
          </li>
          <li>
            <a href="alerts.html">
              <p>Alerts</p>
            </a>
          </li>
        </ul>
      </div>
    </div>

    <!-- MAIN CONTENT -->
    <div class="main-panel">

      <!-- NAVBAR -->
      <nav class="navbar navbar-expand-lg navbar-absolute navbar-transparent">
        <div class="container-fluid">
          <div class="navbar-wrapper">
            <a class="navbar-brand" href="javascript:void(0)">Dashboard Overview</a>
          </div>
          <div class="navbar-actions">
            <button class="btn btn-primary" id="alertSimulationBtn">Alert Simulation</button>
            <button class="btn btn-warning" id="behaviorSimulationBtn" style="margin-left: 10px;">User Behavior</button>
          </div>
        </div>
      </nav>

      <!-- CONTENT -->
      <div class="content">

        <!-- Section 1: Top Row Charts -->
        <section id="overview">
          <div class="row">

            <!-- Overview Charts -->
            <div class="col-12 col-sm-12">
              <div class="card card-chart">
                <div class="card-header">
                  <h5 class="card-category">Alert Tracker</h5>
                  <h2 class="card-title">Alerts</h2>
                </div>
                <div class="card-body">
                  <div class="chart-area"><canvas id="alertChart"></canvas></div>
                </div>
              </div>
            </div>

            <div class="col-lg-6 col-sm-12">
              <div class="card card-chart">
                <div class="card-header">
                  <h5 class="card-category">Vulnerability Tracker</h5>
                  <h2 class="card-title">Vulnerability Types</h2>
                </div>
                <div class="card-body">
                  <div class="chart-area"><canvas id="vulChart"></canvas></div>
                </div>
              </div>
            </div>

            <div class="col-lg-6 col-sm-12">
              <div class="card card-chart">
                <div class="card-header">
                  <h5 class="card-category">Overview</h5>
                  <h3 class="card-title">Alerts by Department</h3>
                </div>
                <div class="card-body">
                  <div class="chart-area">
                    <canvas id="mainBarChart"></canvas>
                  </div>
                </div>
              </div>
            </div>

          </div>
        </section>

        <!-- Section 2: Pie Charts -->
        <section id="pie-charts">
          <div class="row">

            <!-- Pie Chart 1 -->
            <div class="col-lg-4">
              <div class="card card-chart">
                <div class="card-header">
                  <h5 class="card-category">Alerts</h5>
                  <h3 class="card-title">Severity</h3>
                </div>
                <div class="card-body">
                  <div class="chart-area">
                    <canvas id="severityChart"></canvas>
                  </div>
                </div>
              </div>
            </div>

            <!-- Pie Chart 2 -->
            <div class="col-lg-4">
              <div class="card card-chart">
                <div class="card-header">
                  <h5 class="card-category">Alerts</h5>
                  <h3 class="card-title">Status</h3>
                </div>
                <div class="card-body">
                  <div class="chart-area">
                    <canvas id="statusChart"></canvas>
                  </div>
                </div>
              </div>
            </div>

            <!-- Pie Chart 3 -->
            <div class="col-lg-4">
              <div class="card card-chart">
                <div class="card-header">
                  <h5 class="card-category">Alerts</h5>
                  <h3 class="card-title">Asset Type</h3>
                </div>
                <div class="card-body">
                  <div class="chart-area">
                    <canvas id="assetChart"></canvas>
                  </div>
                </div>
              </div>
            </div>

          </div>
        </section>

        <!-- Section 3: Tables -->
        <section id="tables">
          <div class="row">

            <!-- Top Table: High Risk Users -->
            <div class="col-12 col-sm-12">
              <div class="card">
                <div class="card-header">
                  <h4 class="card-title">High Risk Users</h4>
                </div>
                <div class="card-body">
                  <div class="table-responsive">
                    <table id="users-table" class="table tablesorter">
                      <thead class="text-primary">
                        <tr>
                          <th>
                            Name
                            <button class="sort-btn" data-table="users" data-col="0" data-type="string"
                              title="Sort Name">⇅</button>
                          </th>
                          <th>
                            Department
                            <button class="sort-btn" data-table="users" data-col="1" data-type="string"
                              title="Sort Department">⇅</button>
                          </th>
                          <th>
                            Security Training Completion
                            <button class="sort-btn" data-table="users" data-col="2" data-type="bool"
                              title="Sort Training Completion">⇅</button>
                          </th>
                          <th class="text-center">
                            # of Alerts
                            <button class="sort-btn" data-table="users" data-col="3" data-type="number"
                              title="Sort Alerts">⇅</button>
                          </th>
                          <th class="text-center">
                            Risk Score
                            <button class="sort-btn" data-table="users" data-col="4" data-type="number"
                              title="Sort Risk Score">⇅</button>
                          </th>
                        </tr>
                      </thead>
                      <tbody id="users-table-body" class="text-center">
                        <!-- Data will be loaded here by main.js -->
                      </tbody>
                    </table>
                  </div>
                </div>
              </div>
            </div>

            <!-- Bottom Table: Top Vulnerabilities -->
            <div class="col-12 col-sm-12">
              <div class="card">
                <div class="card-header">
                  <h4 class="card-title">Top Vulnerabilities</h4>
                </div>
                <div class="card-body">
                  <div class="table-responsive">

                    <!-- Added id="vuln-table" (optional, but nice for debugging) -->
                    <table class="table tablesorter" id="vuln-table">
                      <thead class="text-primary">
                        <tr>
                          <th>
                            CVE
                            <!-- key must match TABLE_STATE.vuln normalized fields -->
                            <button class="sort-btn" data-table="vuln" data-key="cve" data-type="text"
                              title="Sort CVE">⇅</button>
                          </th>
                          <th>
                            Name
                            <button class="sort-btn" data-table="vuln" data-key="name" data-type="text"
                              title="Sort Name">⇅</button>
                          </th>
                          <th>
                            Severity
                            <button class="sort-btn" data-table="vuln" data-key="severity" data-type="severity"
                              title="Sort Severity">⇅</button>
                          </th>
                          <th class="text-center">
                            # of Alerts
                            <button class="sort-btn" data-table="vuln" data-key="alerts" data-type="number"
                              title="Sort Alerts">⇅</button>
                          </th>
                        </tr>
                      </thead>

                      <!-- main.js fills this dynamically -->
                      <tbody id="vulnerability-table-body" class="text-center">
                        <!-- Data will be loaded here by main.js -->
                      </tbody>
                    </table>

                  </div>
                </div>
              </div>
            </div>

            <!-- Asset Inventory -->
            <div class="col-12 col-sm-12">
              <div class="card">
                <div class="card-header">
                  <h4 class="card-title">Asset Inventory</h4>
                </div>
                <div class="card-body">
                  <div class="table-responsive">

                    <!-- Added id="asset-table" (optional, but nice for debugging) -->
                    <table class="table tablesorter" id="asset-table">
                      <thead class="text-primary">
                        <tr>
                          <th>
                            Asset ID
                            <!-- key must match TABLE_STATE.asset normalized fields -->
                            <button class="sort-btn" data-table="asset" data-key="assetId" data-type="text"
                              title="Sort Asset ID">⇅</button>
                          </th>
                          <th>
                            Asset Name
                            <button class="sort-btn" data-table="asset" data-key="assetName" data-type="text"
                              title="Sort Asset Name">⇅</button>
                          </th>
                          <th>
                            Asset Type
                            <button class="sort-btn" data-table="asset" data-key="assetType" data-type="text"
                              title="Sort Asset Type">⇅</button>
                          </th>
                          <th class="text-center">
                            # of Alerts
                            <button class="sort-btn" data-table="asset" data-key="alerts" data-type="number"
                              title="Sort Alerts">⇅</button>
                          </th>
                          <th class="text-center">
                            Highest Severity
                            <button class="sort-btn" data-table="asset" data-key="highestSeverity" data-type="severity"
                              title="Sort Severity">⇅</button>
                          </th>
                        </tr>
                      </thead>

                      <tbody id="asset-table-body" class="text-center">
                        <!-- Data will be loaded here by main.js -->
                      </tbody>

                    </table>

                  </div>
                </div>
              </div>
            </div>

          </div>
        </section>

      </div>

    </div>
  </div>

  <!-- CVE DETAILS MODAL -->
  <div id="cve-modal" class="modal-hidden">
    <div class="modal-card">
      <div class="modal-header">
        <h4 id="cve-modal-title">CVE Details</h4>
        <button id="cve-modal-close" class="modal-close">×</button>
      </div>

      <div id="cve-modal-content" class="modal-content">
        <!-- Filled by main.js -->
      </div>
    </div>
  </div>

  <!-- Alert Simulation Modal -->
  <div id="alertSimulationModal" class="modal-hidden">
    <div class="modal-card">
      <div class="modal-header">
        <h4>Alert Simulation</h4>
        <button id="alertModalClose" class="modal-close">×</button>
      </div>
      <div class="modal-content">
        <p>Enter your email address to receive a simulated security alert:</p>
        <div class="modal-form">
          <input type="email" id="alertEmail" placeholder="your-email@example.com" required />
          <button class="btn btn-primary" id="triggerAlertBtn">Trigger Alert</button>
        </div>
        <div id="alertMessage" class="alert-message"></div>
      </div>
    </div>
  </div>

  <!-- User Behavior Simulation Modal -->
  <div id="behaviorSimulationModal" class="modal-hidden">
    <div class="modal-card">
      <div class="modal-header">
        <h4>User Behavior Simulation</h4>
        <button id="behaviorModalClose" class="modal-close">×</button>
      </div>
      <div class="modal-content">
        <p>Simulate a risky user behavior:</p>
        <div class="modal-form">
          <label style="display:block; text-align:left; margin-bottom:5px;">User:</label>
          <select id="behaviorUserSelect"
            style="width:100%; padding:8px; margin-bottom: 15px; border-radius:4px; border:1px solid #ddd;">
            <!-- Populated by main.js -->
          </select>

          <label style="display:block; text-align:left; margin-bottom:5px;">Behavior:</label>
          <select id="behaviorTypeSelect"
            style="width:100%; padding:8px; margin-bottom: 20px; border-radius:4px; border:1px solid #ddd;">
            <option value="FailedLogin" data-risk="5">Failed Login Attempt (Risk: 5)</option>
            <option value="SensitiveAccess" data-risk="15">Sensitive Data Access (Risk: 15)</option>
            <option value="PolicyViolation" data-risk="25">Security Policy Violation (Risk: 25)</option>
            <option value="UnusualLocation" data-risk="10">Login from Unusual Location (Risk: 10)</option>
            <option value="SuspiciousDownload" data-risk="20">Suspicious File Download (Risk: 20)</option>
          </select>

          <button class="btn btn-warning" id="triggerBehaviorBtn" style="width:100%;">Log Behavior</button>
        </div>
        <div id="behaviorMessage" class="alert-message" style="margin-top:15px;"></div>
      </div>
    </div>
  </div>

  <!-- SCRIPTS -->
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js@2.9.4/dist/Chart.min.js"></script>
  <script src="main.js"></script>

</body>

</html>